<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grade Average Calculator</title>
</head>
<body>
  <h1>Grade Average Calculator</h1>
  <p>Calculate the average of your Grades</p>
  <div id="subjectsDiv">
  </div>
  <form id="newSubjectForm">
    <select id="subjectSelect" required>
      <option value="" disabled selected>Select subject…</option>
      <option value="Math">Math</option>
      <option value="English">English</option>
      <option value="French">French</option>
      <option value="German">German</option>
      <option value="Biology">Biology</option>
      <option value="Physics">Physics</option>
      <option value="History">History</option>
      <option value="other">Custom</option>
    </select>

    <input
      type="text"
      id="customSubjectInput"
      placeholder="Type custom subject…"
      style="display:none; margin-top:0.5em;"
    >

    <input type="number" list="grades" name="addGrade" id="addGradeInput" placeholder="2">
    <datalist id="grades">
      <option value="1"></option>
      <option value="2"></option>
      <option value="3"></option>
      <option value="4"></option>
      <option value="5"></option>
      <option value="6"></option>
    </datalist>

    <button type="submit">Add new Subject</button>
  </form>
  <script>
    const grades = [];

    const form = document.getElementById('newSubjectForm');
    const subjectSelect = document.getElementById('subjectSelect');
    const customInput = document.getElementById('customSubjectInput');
    const gradeInput = document.getElementById('addGradeInput');
    const subjectsDiv = document.getElementById('subjectsDiv');

    form.addEventListener('submit', (e) => {
      e.preventDefault();

      const subject = (subjectSelect.value === 'custom');
      const grade = parseFloat(gradeInput.value);

      if (!subject) {
        alert('Please enter or select a subject.')
        return;
      }
      if (isNaN(grade)) {
        alert('Please enter a valid grade.');
      }

      grades.push({ subject, grade });

      newSubject.value = '';
      newGrade.value = '';

      updateList();
    })

    function updateList() {
      subjectsDiv.innerHTML = ''; // Clear old content

      grades.forEach(entry => {
        const p = document.createElement('p');
        p.textContent = entry.subject + ': ' + entry.grade;
        subjectsDiv.appendChild(p);

        /* IDEA: Add a remove button behind every object */
      });

      const sum = grades.reduce((acc, cur) => acc + parseFloat(cur.grade), 0);
      const avg = (sum / grades.length) .toFixed(2);
      const avgP = document.createElement('p');
      avgP.innerHTML = '<strong>' + 'Average Grade: ' + avg + '</strong>';
      subjectsDiv.appendChild(avgP);
      console.log(avg);
    }

    window.onload = () => {
      newSubject.value = '';
      newGrade.value = '';
    }
  </script>
</body>
</html>
